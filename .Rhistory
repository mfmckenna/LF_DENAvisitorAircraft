# Analysis of DENA vistor survey data set- acceptability of overflights
# started by mfm and DJ 2012.10.31
rm(list = ls())
load("DENA_ModelInputData.RData")
dataNames = as.data.frame(colnames(ALL2))
dataNames #NOTE LOTS OF VARIABLES NOT USED!!!
#simplify input variables for precidicting "acceptibility"
# acceptibility ~ LAeq30s + ClipSeqence + Flight_interest + Location
dataIn = ALL2[c(1:5,83,94,75,37,6)]
dataNames = as.data.frame(colnames(dataIn))
dataNames
# LOAD STATISTICAL PACKAGES
#-------------------------------------------------------------------------------------------------------
library(lme4) # linear models
library(mgcv) # GAM models
library(AICcmodavg) # model averaging, perfered over MuMin library(MuMIn)
library(ordinal)
library(stringr)
library(MASS)
# PLOT VARIABLES
#-------------------------------------------------------------------------------------------------------
# Distribution of the response variables
par(mfcol=c(2,3), mar=c(2,2,2,0.5), oma=c(0.5,0.5,0.5,0.5))
hist(dataIn$RC_Acceptability, main = "Acceptibility", xlab = "", freq = FALSE)
hist(dataIn$LAeq30s, main = "Sound level", xlab = "")
hist(dataIn$ClipSeqence, main = "Sequence", xlab = "")
hist(dataIn$Flight_interest, main = "Flight Interest", xlab = "")
hist(dataIn$Location, main = "Location", xlab = "")
boxplot(dataIn$LAeq30s ~ factor(dataIn$ClipSeqence), main = "Seq vs level")
# Analysis of DENA vistor survey data set- acceptability of overflights
# started by mfm and DJ 2012.10.31
rm(list = ls())
# data organize/format using: StatModelDataReady_DENAvisitor_20210217.R
# READ IN DATA FRAME
#-------------------------------------------------------------------------------------------------------
#created Rproject to avoid this step...
#inDir = "G:\\My Drive\\ActiveProjects\\LF_DENAvisitorAircraft\\code" # SET TO LOCAL DIRECTORY
#setwd(inDir)
load("DENA_ModelInputData.RData")
dataNames = as.data.frame(colnames(ALL2))
dataNames #NOTE LOTS OF VARIABLES NOT USED!!!
#simplify input variables for precidicting "acceptibility"
# acceptibility ~ LAeq30s + ClipSeqence + Flight_interest + Location
dataIn = ALL2[c(1:5,83,94,75,37,6)]
dataNames = as.data.frame(colnames(dataIn))
dataNames
# LOAD STATISTICAL PACKAGES
#-------------------------------------------------------------------------------------------------------
library(lme4) # linear models
library(mgcv) # GAM models
library(AICcmodavg) # model averaging, perfered over MuMin library(MuMIn)
library(ordinal)
library(stringr)
library(MASS)
# PLOT VARIABLES
#-------------------------------------------------------------------------------------------------------
# Distribution of the response variables
par(mfcol=c(2,3), mar=c(2,2,2,0.5), oma=c(0.5,0.5,0.5,0.5))
hist(dataIn$RC_Acceptability, main = "Acceptibility", xlab = "", freq = FALSE)
hist(dataIn$LAeq30s, main = "Sound level", xlab = "")
hist(dataIn$ClipSeqence, main = "Sequence", xlab = "")
hist(dataIn$Flight_interest, main = "Flight Interest", xlab = "")
hist(dataIn$Location, main = "Location", xlab = "")
boxplot(dataIn$LAeq30s ~ factor(dataIn$ClipSeqence), main = "Seq vs level")
# BUILD STATISTICAL MODELS
# CLMM: Cumulative Link Models, response variable as an ordered factor!
# good for data with ordered categorical response variables: https://rcompanion.org/handbook/G_01.html
#-------------------------------------------------------------------------------------------------------
#MAKE response variable as an ordered factor
#testing: #ALL2$RC_Acceptability[1:5]  #ordered( ( ALL2$RC_Acceptability[1:5] ) )
dataIn$RC_Acceptability = ordered( ( ALL2$RC_Acceptability ) )
# is.ordered(dataIn$RC_Acceptability) #YES!
#did it work?
par(mfcol=c(1,1))
plot(dataIn$RC_Acceptability)
dataIn$Location   =  as.factor(dataIn$Location)
#dataIn$ClipSeqence   =  as.factor(dataIn$ClipSeqence)
#dataIn3$ClipSeqence = ordered((dataIn3$ClipSeqence))
#BUILD candidate models-- MIXED EFFECT models, ID as random effect
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
dataIn3 = dataIn2[,5:10]  #remove unused columns
dataIn3$ID = as.factor( dataIn3$ID)
#length (unique(dataIn3$ID) ) * 5
#colnames(dataIn3)
#LOCATION as factor
dataIn$Location   =  as.factor(dataIn$Location)
#BUILD candidate models-- MIXED EFFECT models, ID as random effect
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
#CLIP SEQUENCE- ordered factor b/c happened in order vs numeric value??
dataIn3$ClipSeqence = ordered((dataIn3$ClipSeqence))
is.ordered(dataIn$ClipSeqence) #YES!
#CLIP SEQUENCE- ordered factor b/c happened in order vs numeric value??
dataIn$ClipSeqence = ordered((dataIn$ClipSeqence))
is.ordered(dataIn$ClipSeqence) #YES!
dataIn$ID = as.factor( dataIn$ID)
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
nrow(dataIn) - nrow(dataIn2)
dataIn3 = dataIn2[,5:10]  #remove unused columns
## BUILD candidate models-- MIXED EFFECT models, ID as random effect
modlCLMM <- list()
# global
modlCLMM[[1]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest + Location , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# one variable
modlCLMM[[2]]  = clmm2(RC_Acceptability  ~ LAeq30s                                            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[3]]  = clmm2(RC_Acceptability  ~ ClipSeqence                                        , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[4]]  = clmm2(RC_Acceptability  ~ Flight_interest                                    , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[5]]  = clmm2(RC_Acceptability  ~ Location                                           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# two variables
modlCLMM[[6]]  = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest                          , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[7]]  = clmm2(RC_Acceptability  ~ LAeq30s + Location                                 , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[8]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence                              , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[9]]  = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest                      , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[10]] = clmm2(RC_Acceptability  ~ ClipSeqence + Location                             , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[11]] = clmm2(RC_Acceptability  ~ Flight_interest + Location                         , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
#three variables
modlCLMM[[12]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[13]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Location                   , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[14]] = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest + Location               , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[15]] = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest + Location           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# EVALUATE STATISTICAL MODELS
#-------------------------------------------------------------------------------------------------------
AIC_CLMM = NULL
for (ii in 1:length(modlCLMM)){
cat("model ",ii,": AIC=", AIC(modlCLMM[[ii]]),"\n" )
AIC_CLMM = rbind(AIC_CLMM, c(ii,AIC(modlCLMM[[ii]])))
}
modOrder = as.data.frame( AIC_CLMM[order(AIC_CLMM[,2]) ,] )
#modOrder[2:length(modlCLMM),3] = round( diff(modOrder[,2]))
modOrder
bestModCLM   = ( modlCLMM[[modOrder[1,1]]] )
summary(bestModCLM)
View(modOrder)
View(modOrder)
View(modOrder)
View(modOrder)
# Analysis of DENA vistor survey data set- acceptability of overflights
# started by mfm and DJ 2012.10.31
rm(list = ls())
# data organize/format using: StatModelDataReady_DENAvisitor_20210217.R
# READ IN DATA FRAME
#-------------------------------------------------------------------------------------------------------
#created Rproject to avoid this step...
#inDir = "G:\\My Drive\\ActiveProjects\\LF_DENAvisitorAircraft\\code" # SET TO LOCAL DIRECTORY
#setwd(inDir)
load("DENA_ModelInputData.RData")
dataNames = as.data.frame(colnames(ALL2))
dataNames #NOTE LOTS OF VARIABLES NOT USED!!!
#simplify input variables for precidicting "acceptibility"
# acceptibility ~ LAeq30s + ClipSeqence + Flight_interest + Location
dataIn = ALL2[c(1:5,83,94,75,37,6)]
dataNames = as.data.frame(colnames(dataIn))
dataNames
# LOAD STATISTICAL PACKAGES
#-------------------------------------------------------------------------------------------------------
library(lme4) # linear models
library(mgcv) # GAM models
library(AICcmodavg) # model averaging, perfered over MuMin library(MuMIn)
library(ordinal)
library(stringr)
library(MASS)
# PLOT VARIABLES
#-------------------------------------------------------------------------------------------------------
# Distribution of the response variables
par(mfcol=c(2,3), mar=c(2,2,2,0.5), oma=c(0.5,0.5,0.5,0.5))
hist(dataIn$RC_Acceptability, main = "Acceptibility", xlab = "", freq = FALSE)
hist(dataIn$LAeq30s, main = "Sound level", xlab = "")
hist(dataIn$ClipSeqence, main = "Sequence", xlab = "")
hist(dataIn$Flight_interest, main = "Flight Interest", xlab = "")
hist(dataIn$Location, main = "Location", xlab = "")
boxplot(dataIn$LAeq30s ~ factor(dataIn$ClipSeqence), main = "Seq vs level")
# BUILD STATISTICAL MODELS
# CLMM: Cumulative Link Models, response variable as an ordered factor!
# good for data with ordered categorical response variables: https://rcompanion.org/handbook/G_01.html
#-------------------------------------------------------------------------------------------------------
## FORMAT VARIABLES
#ACCEPTIBILITY as ordered factor
dataIn$RC_Acceptability = ordered( ( ALL2$RC_Acceptability ) )
# CHECK: is.ordered(dataIn$RC_Acceptability) #YES!
#LOCATION as factor
dataIn$Location   =  as.factor(dataIn$Location)
#CLIP SEQUENCE- ordered factor b/c happened in order vs numeric value??
dataIn$ClipSeqence = ordered((dataIn$ClipSeqence))
#ID- as factor
dataIn$ID = as.factor( dataIn$ID)
## CLEAN UP DATA TABLE
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
dataIn3 = dataIn2[,5:10]  #remove unused columns
# Analysis of DENA vistor survey data set- acceptability of overflights
# started by mfm and DJ 2012.10.31
rm(list = ls())
# data organize/format using: StatModelDataReady_DENAvisitor_20210217.R
# READ IN DATA FRAME
#-------------------------------------------------------------------------------------------------------
#created Rproject to avoid this step...
#inDir = "G:\\My Drive\\ActiveProjects\\LF_DENAvisitorAircraft\\code" # SET TO LOCAL DIRECTORY
#setwd(inDir)
load("DENA_ModelInputData.RData")
dataNames = as.data.frame(colnames(ALL2))
dataNames #NOTE LOTS OF VARIABLES NOT USED!!!
#simplify input variables for precidicting "acceptibility"
# acceptibility ~ LAeq30s + ClipSeqence + Flight_interest + Location
dataIn = ALL2[c(1:5,83,94,75,37,6)]
dataNames = as.data.frame(colnames(dataIn))
dataNames
# LOAD STATISTICAL PACKAGES
#-------------------------------------------------------------------------------------------------------
library(lme4) # linear models
library(mgcv) # GAM models
library(AICcmodavg) # model averaging, perfered over MuMin library(MuMIn)
library(ordinal)
library(stringr)
library(MASS)
# PLOT VARIABLES
#-------------------------------------------------------------------------------------------------------
# Distribution of the response variables
par(mfcol=c(2,3), mar=c(2,2,2,0.5), oma=c(0.5,0.5,0.5,0.5))
hist(dataIn$RC_Acceptability, main = "Acceptibility", xlab = "", freq = FALSE)
hist(dataIn$LAeq30s, main = "Sound level", xlab = "")
hist(dataIn$ClipSeqence, main = "Sequence", xlab = "")
hist(dataIn$Flight_interest, main = "Flight Interest", xlab = "")
hist(dataIn$Location, main = "Location", xlab = "")
boxplot(dataIn$LAeq30s ~ factor(dataIn$ClipSeqence), main = "Seq vs level")
# BUILD STATISTICAL MODELS
# CLMM: Cumulative Link Models, response variable as an ordered factor!
# good for data with ordered categorical response variables: https://rcompanion.org/handbook/G_01.html
#-
## FORMAT VARIABLES
#ACCEPTIBILITY as ordered factor
dataIn$RC_Acceptability = ordered( ( ALL2$RC_Acceptability ) )
# CHECK: is.ordered(dataIn$RC_Acceptability) #YES!
#LOCATION as factor
dataIn$Location   =  as.factor(dataIn$Location)
## FORMAT VARIABLES
#ACCEPTIBILITY as ordered factor
dataIn$RC_Acceptability = ordered( ( ALL2$RC_Acceptability ) )
# CHECK: is.ordered(dataIn$RC_Acceptability) #YES!
#LOCATION as factor
dataIn$Location   =  as.factor(dataIn$Location)
#CLIP SEQUENCE- ordered factor b/c happened in order vs numeric value??
#dataIn$ClipSeqence = ordered((dataIn$ClipSeqence))
dataIn$ClipSeqence = as.factor((dataIn$ClipSeqence))
#ID- as factor
dataIn$ID = as.factor( dataIn$ID)
## CLEAN UP DATA TABLE
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
dataIn3 = dataIn2[,5:10]  #remove unused columns
## BUILD candidate models-- MIXED EFFECT models, ID as random effect
modlCLMM <- list()
# global
modlCLMM[[1]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest + Location , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# one variable
modlCLMM[[2]]  = clmm2(RC_Acceptability  ~ LAeq30s                                            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[3]]  = clmm2(RC_Acceptability  ~ ClipSeqence                                        , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[4]]  = clmm2(RC_Acceptability  ~ Flight_interest                                    , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[5]]  = clmm2(RC_Acceptability  ~ Location                                           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# two variables
modlCLMM[[6]]  = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest                          , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[7]]  = clmm2(RC_Acceptability  ~ LAeq30s + Location                                 , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[8]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence                              , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[9]]  = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest                      , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[10]] = clmm2(RC_Acceptability  ~ ClipSeqence + Location                             , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[11]] = clmm2(RC_Acceptability  ~ Flight_interest + Location                         , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
#three variables
modlCLMM[[12]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[13]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Location                   , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[14]] = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest + Location               , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[15]] = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest + Location           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# Analysis of DENA vistor survey data set- acceptability of overflights
# started by mfm and DJ 2012.10.31
rm(list = ls())
# data organize/format using: StatModelDataReady_DENAvisitor_20210217.R
# READ IN DATA FRAME
#-------------------------------------------------------------------------------------------------------
#created Rproject to avoid this step...
#inDir = "G:\\My Drive\\ActiveProjects\\LF_DENAvisitorAircraft\\code" # SET TO LOCAL DIRECTORY
#setwd(inDir)
load("DENA_ModelInputData.RData")
dataNames = as.data.frame(colnames(ALL2))
dataNames #NOTE LOTS OF VARIABLES NOT USED!!!
#simplify input variables for precidicting "acceptibility"
# acceptibility ~ LAeq30s + ClipSeqence + Flight_interest + Location
dataIn = ALL2[c(1:5,83,94,75,37,6)]
dataNames = as.data.frame(colnames(dataIn))
dataNames
# LOAD STATISTICAL PACKAGES
#-------------------------------------------------------------------------------------------------------
library(lme4) # linear models
library(mgcv) # GAM models
library(AICcmodavg) # model averaging, perfered over MuMin library(MuMIn)
library(ordinal)
library(stringr)
library(MASS)
# PLOT VARIABLES
#-------------------------------------------------------------------------------------------------------
# Distribution of the response variables
par(mfcol=c(2,3), mar=c(2,2,2,0.5), oma=c(0.5,0.5,0.5,0.5))
hist(dataIn$RC_Acceptability, main = "Acceptibility", xlab = "", freq = FALSE)
hist(dataIn$LAeq30s, main = "Sound level", xlab = "")
hist(dataIn$ClipSeqence, main = "Sequence", xlab = "")
hist(dataIn$Flight_interest, main = "Flight Interest", xlab = "")
hist(dataIn$Location, main = "Location", xlab = "")
boxplot(dataIn$LAeq30s ~ factor(dataIn$ClipSeqence), main = "Seq vs level")
# BUILD STATISTICAL MODELS
# CLMM: Cumulative Link Models, response variable as an ordered factor!
# good for data with ordered categorical response variables: https://rcompanion.org/handbook/G_01.html
#-------------------------------------------------------------------------------------------------------
## FORMAT VARIABLES
#ACCEPTIBILITY as ordered factor
dataIn$RC_Acceptability = ordered( ( ALL2$RC_Acceptability ) )
# CHECK: is.ordered(dataIn$RC_Acceptability) #YES!
#LOCATION as factor
dataIn$Location   =  as.factor(dataIn$Location)
#CLIP SEQUENCE- ordered factor b/c happened in order vs numeric value??
#dataIn$ClipSeqence = ordered((dataIn$ClipSeqence))
#ID- as factor
dataIn$ID = as.factor( dataIn$ID)
## CLEAN UP DATA TABLE
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
dataIn3 = dataIn2[,5:10]  #remove unused columns
## CLEAN UP DATA TABLE
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
dataIn3 = dataIn2[,5:10]  #remove unused columns
## BUILD candidate models-- MIXED EFFECT models, ID as random effect
modlCLMM <- list()
# global
modlCLMM[[1]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest + Location , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# one variable
modlCLMM[[2]]  = clmm2(RC_Acceptability  ~ LAeq30s                                            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[3]]  = clmm2(RC_Acceptability  ~ ClipSeqence                                        , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[4]]  = clmm2(RC_Acceptability  ~ Flight_interest                                    , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[5]]  = clmm2(RC_Acceptability  ~ Location                                           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# two variables
modlCLMM[[6]]  = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest                          , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[7]]  = clmm2(RC_Acceptability  ~ LAeq30s + Location                                 , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[8]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence                              , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[9]]  = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest                      , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[10]] = clmm2(RC_Acceptability  ~ ClipSeqence + Location                             , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[11]] = clmm2(RC_Acceptability  ~ Flight_interest + Location                         , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
#three variables
modlCLMM[[12]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[13]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Location                   , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[14]] = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest + Location               , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[15]] = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest + Location           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# EVALUATE STATISTICAL MODELS
#-------------------------------------------------------------------------------------------------------
AIC_CLMM = NULL
for (ii in 1:length(modlCLMM)){
cat("model ",ii,": AIC=", AIC(modlCLMM[[ii]]),"\n" )
AIC_CLMM = rbind(AIC_CLMM, c(ii,AIC(modlCLMM[[ii]])))
}
modOrder = as.data.frame( AIC_CLMM[order(AIC_CLMM[,2]) ,] )
#modOrder[2:length(modlCLMM),3] = round( diff(modOrder[,2]))
modOrder
# Analysis of DENA vistor survey data set- acceptability of overflights
# started by mfm and DJ 2012.10.31
rm(list = ls())
# data organize/format using: StatModelDataReady_DENAvisitor_20210217.R
# READ IN DATA FRAME
#-------------------------------------------------------------------------------------------------------
#created Rproject to avoid this step...
#inDir = "G:\\My Drive\\ActiveProjects\\LF_DENAvisitorAircraft\\code" # SET TO LOCAL DIRECTORY
#setwd(inDir)
load("DENA_ModelInputData.RData")
dataNames = as.data.frame(colnames(ALL2))
dataNames #NOTE LOTS OF VARIABLES NOT USED!!!
#simplify input variables for precidicting "acceptibility"
# acceptibility ~ LAeq30s + ClipSeqence + Flight_interest + Location
dataIn = ALL2[c(1:5,83,94,75,37,6)]
dataNames = as.data.frame(colnames(dataIn))
dataNames
# LOAD STATISTICAL PACKAGES
#-------------------------------------------------------------------------------------------------------
library(lme4) # linear models
library(mgcv) # GAM models
library(AICcmodavg) # model averaging, perfered over MuMin library(MuMIn)
library(ordinal)
library(stringr)
library(MASS)
# PLOT VARIABLES
#-------------------------------------------------------------------------------------------------------
# Distribution of the response variables
par(mfcol=c(2,3), mar=c(2,2,2,0.5), oma=c(0.5,0.5,0.5,0.5))
hist(dataIn$RC_Acceptability, main = "Acceptibility", xlab = "", freq = FALSE)
hist(dataIn$LAeq30s, main = "Sound level", xlab = "")
hist(dataIn$ClipSeqence, main = "Sequence", xlab = "")
hist(dataIn$Flight_interest, main = "Flight Interest", xlab = "")
hist(dataIn$Location, main = "Location", xlab = "")
boxplot(dataIn$LAeq30s ~ factor(dataIn$ClipSeqence), main = "Seq vs level")
# BUILD STATISTICAL MODELS
# CLMM: Cumulative Link Models, response variable as an ordered factor!
# good for data with ordered categorical response variables: https://rcompanion.org/handbook/G_01.html
#-------------------------------------------------------------------------------------------------------
## FORMAT VARIABLES
#ACCEPTIBILITY as ordered factor
dataIn$RC_Acceptability = ordered( ( ALL2$RC_Acceptability ) )
# CHECK: is.ordered(dataIn$RC_Acceptability) #YES!
#LOCATION as factor
dataIn$Location   =  as.factor(dataIn$Location)
dataIn$Flight_interest = as.factor( dataIn$Flight_interest)
#ID- as factor
dataIn$ID = as.factor( dataIn$ID)
## CLEAN UP DATA TABLE
dataIn2 = na.omit(dataIn) # CK: nrow(dataIn) - nrow(dataIn2)
dataIn3 = dataIn2[,5:10]  #remove unused columns
## BUILD candidate models-- MIXED EFFECT models, ID as random effect
modlCLMM <- list()
# global
modlCLMM[[1]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest + Location , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# one variable
modlCLMM[[2]]  = clmm2(RC_Acceptability  ~ LAeq30s                                            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[3]]  = clmm2(RC_Acceptability  ~ ClipSeqence                                        , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[4]]  = clmm2(RC_Acceptability  ~ Flight_interest                                    , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[5]]  = clmm2(RC_Acceptability  ~ Location                                           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# two variables
modlCLMM[[6]]  = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest                          , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[7]]  = clmm2(RC_Acceptability  ~ LAeq30s + Location                                 , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[8]]  = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence                              , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[9]]  = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest                      , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[10]] = clmm2(RC_Acceptability  ~ ClipSeqence + Location                             , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[11]] = clmm2(RC_Acceptability  ~ Flight_interest + Location                         , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
#three variables
modlCLMM[[12]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Flight_interest            , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[13]] = clmm2(RC_Acceptability  ~ LAeq30s + ClipSeqence + Location                   , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[14]] = clmm2(RC_Acceptability  ~ LAeq30s + Flight_interest + Location               , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
modlCLMM[[15]] = clmm2(RC_Acceptability  ~ ClipSeqence + Flight_interest + Location           , random = ID, data=dataIn3, nAGQ=10, na.action = na.omit, Hess =TRUE )
# EVALUATE STATISTICAL MODELS
#-------------------------------------------------------------------------------------------------------
AIC_CLMM = NULL
for (ii in 1:length(modlCLMM)){
cat("model ",ii,": AIC=", AIC(modlCLMM[[ii]]),"\n" )
AIC_CLMM = rbind(AIC_CLMM, c(ii,AIC(modlCLMM[[ii]])))
}
modOrder = as.data.frame( AIC_CLMM[order(AIC_CLMM[,2]) ,] )
#modOrder[2:length(modlCLMM),3] = round( diff(modOrder[,2]))
modOrder
# EVALUATE STATISTICAL MODELS
#-------------------------------------------------------------------------------------------------------
AIC_CLMM = NULL
for (ii in 1:length(modlCLMM)){
cat("model ",ii,": AIC=", AIC(modlCLMM[[ii]]),"\n" )
AIC_CLMM = rbind(AIC_CLMM, c(ii,AIC(modlCLMM[[ii]])))
}
modOrder = as.data.frame( AIC_CLMM[order(AIC_CLMM[,2]) ,] )
#modOrder[2:length(modlCLMM),3] = round( diff(modOrder[,2]))
modOrder
bestModCLM   = ( modlCLMM[[modOrder[1,1]]] )
summary(bestModCLM)
